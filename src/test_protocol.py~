from twisted.trial import unittest
from server import *

class TestTimelineProtocol(unittest.TestCase):
	def setUp(self):
		favtory = TimelineFactory()
		self.proto = factory.buildProtocol(('127.0.0.1',0))
		self.tr = proto_helpers.StringTransport()
		self.proto.makeConnection(self.tr)

	def _do(self, line):
		self.proto.lineReceived(line)
		return self.tr.value

	def test_parse(self):
		resp = self._do("push [1, foo]")
		self.assertEquals("[(1,foo)]", resp)
		
